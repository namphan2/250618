


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>MoMoCompose Coverage Report > PaymentTransferContentV2Kt</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope: MoMoCompose<span class="separator">|</span>    <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">vn.momo.compose.payment.singleBill.presentation.features.views.sbTransferV2.screens</a>
</div>

<h1>Coverage Summary for Class: PaymentTransferContentV2Kt (vn.momo.compose.payment.singleBill.presentation.features.views.sbTransferV2.screens)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">PaymentTransferContentV2Kt</td>
<td class="coverageStat">
  <span class="percent">
    20%
  </span>
  <span class="absValue">
    (1/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    30%
  </span>
  <span class="absValue">
    (6/20)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    46.8%
  </span>
  <span class="absValue">
    (22/47)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    20.7%
  </span>
  <span class="absValue">
    (99/479)
  </span>
</td>
</tr>
  <tr>
    <td class="name">PaymentTransferContentV2Kt$PaymentTransferContentV2$2$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/33)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentTransferContentV2Kt$PaymentTransferContentV2$2$1$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/109)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentTransferContentV2Kt$PaymentTransferContentV2$2$1$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/16)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/293)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentTransferContentV2Kt$PaymentTransferContentV2$2$1$3$2$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentTransferContentV2Kt$PaymentTransferContentV2$2$1$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/57)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentTransferContentV2Kt$PaymentTransferContentV2$2$1$4$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    9.1%
  </span>
  <span class="absValue">
    (1/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    25%
  </span>
  <span class="absValue">
    (6/24)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    26.8%
  </span>
  <span class="absValue">
    (22/82)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    10%
  </span>
  <span class="absValue">
    (99/989)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package vn.momo.compose.payment.singleBill.presentation.features.views.sbTransferV2.screens
&nbsp;
&nbsp;import androidx.compose.foundation.layout.fillMaxWidth
&nbsp;import androidx.compose.runtime.Composable
&nbsp;import androidx.compose.runtime.collectAsState
&nbsp;import androidx.compose.runtime.getValue
&nbsp;import androidx.compose.runtime.remember
&nbsp;import androidx.compose.ui.Modifier
&nbsp;import kotlinx.collections.immutable.PersistentList
&nbsp;import kotlinx.collections.immutable.toPersistentList
&nbsp;import org.jetbrains.compose.resources.stringResource
&nbsp;import vn.momo.compose.payment.base.domain.entities.DisableType
&nbsp;import vn.momo.compose.payment.base.domain.entities.EnumMoneySource
&nbsp;import vn.momo.compose.payment.base.domain.entities.SOFGroup
&nbsp;import vn.momo.compose.payment.base.domain.entities.SOFItem
&nbsp;import vn.momo.compose.payment.base.domain.entities.Sof
&nbsp;import vn.momo.compose.payment.base.domain.entities.SofAction
&nbsp;import vn.momo.compose.payment.base.domain.entities.SofActionType
&nbsp;import vn.momo.compose.payment.base.domain.entities.SofBadge
&nbsp;import vn.momo.compose.payment.base.domain.entities.TaglineType
&nbsp;import vn.momo.compose.payment.payx.presentation.features.paymentV2.view.component.Body
&nbsp;import vn.momo.compose.payment.payx.presentation.features.paymentV2.view.component.InlineMessageError
&nbsp;import vn.momo.compose.payment.payx.presentation.features.paymentV2.view.component.PickPromotionBlock
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.PromotionStatus
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.TrackStatusValue
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.modifiers.scaledPadding
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.modifiers.shadowBill
&nbsp;import vn.momo.compose.payment.payx.utils.constant.ServiceFeatureCode
&nbsp;import vn.momo.compose.payment.singleBill.presentation.features.views.sbTransferV2.components.TransferPayLaterBlock
&nbsp;import vn.momo.compose.payment.singleBill.presentation.features.views.sbTransferV2.components.TransferPaymentInfoV2
&nbsp;import vn.momo.compose.payment.singleBill.presentation.features.views.sbTransferV2.components.TransferSofBlock
&nbsp;import vn.momo.compose.payment.singleBill.presentation.viewModel.PaymentSingleBillVM
&nbsp;import vn.momo.compose.resources.Res
&nbsp;import vn.momo.compose.resources.badgeInvestmentMessage
&nbsp;import vn.momo.compose.resources.topUpInvestment
&nbsp;import vn.momo.kits.const.Colors
&nbsp;
&nbsp;@Composable
&nbsp;fun PaymentTransferContentV2(
&nbsp;    viewModel: PaymentSingleBillVM,
<b class="nc">&nbsp;) {</b>
<b class="nc">&nbsp;    val state by viewModel.state.collectAsState()</b>
<b class="nc">&nbsp;    val sofState by viewModel.sofSlice.state.collectAsState()</b>
<b class="nc">&nbsp;    val sofList =</b>
<b class="nc">&nbsp;        formatSofListWithPromoteInvestment(</b>
<b class="nc">&nbsp;            sofState.groupOfSof.debit,</b>
<b class="nc">&nbsp;            state.amount.total.value,</b>
<b class="nc">&nbsp;            stringResource(Res.string.badgeInvestmentMessage),</b>
<b class="nc">&nbsp;            stringResource(Res.string.topUpInvestment)</b>
&nbsp;        )
<b class="nc">&nbsp;    val cta = sofState.cta</b>
<b class="nc">&nbsp;    val (payLater, isNoSofAvailable, windowSize) = remember(sofState.list) {</b>
<b class="nc">&nbsp;        val payLater = sofState.list.find { it.isSource(EnumMoneySource.PayLater) }</b>
<b class="nc">&nbsp;        val isNoSofAvailable = sofState.list.none { it.available }</b>
<b class="nc">&nbsp;        val windowSize = if (sofState.list.any { it.isSource(EnumMoneySource.Investment) }) 3 else 2</b>
<b class="nc">&nbsp;        Triple(payLater, isNoSofAvailable, windowSize)</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    val blockModifier = Modifier.fillMaxWidth().scaledPadding(horizontal = 12f)</b>
&nbsp;
<b class="nc">&nbsp;    Body(</b>
<b class="nc">&nbsp;        modifier = Modifier.scaledPadding(vertical = 12f)</b>
<b class="nc">&nbsp;    ) {</b>
<b class="nc">&nbsp;        blockKey(&quot;payment_transfer_info_block&quot;, modifier = blockModifier.shadowBill()) {</b>
<b class="nc">&nbsp;            TransferPaymentInfoV2(invoices = state.invoice, headerInfo = viewModel.props.headerInfo)</b>
&nbsp;        }
<b class="nc">&nbsp;        blockKey(&quot;payment_transfer_promotion_block&quot;) {</b>
<b class="nc">&nbsp;            PickPromotionBlock(</b>
<b class="nc">&nbsp;                promotion = state.promotion,</b>
<b class="nc">&nbsp;                errorIcon = PromotionStatus(</b>
<b class="nc">&nbsp;                    &quot;16_navigation_close_circle_full&quot;,</b>
<b class="nc">&nbsp;                    Colors.black_17,</b>
<b class="nc">&nbsp;                    TrackStatusValue.AT_LEAST_ONE_INVALID.id</b>
&nbsp;                ),
<b class="nc">&nbsp;                inlineMessage = InlineMessageError(</b>
<b class="nc">&nbsp;                    description = state.promotion.promoDisplay.firstOrNull()?.errorDesc,</b>
<b class="nc">&nbsp;                    showIconClose = false</b>
&nbsp;                ),
<b class="nc">&nbsp;                hideAmount = false,</b>
<b class="nc">&nbsp;                onMissionShowed = {},</b>
<b class="nc">&nbsp;                onSelectPromotion = viewModel::navigateChoosePromotionV2</b>
&nbsp;            )
&nbsp;        }
<b class="nc">&nbsp;        blockKey(&quot;payment_transfer_sof_block&quot;, modifier = blockModifier) {</b>
<b class="nc">&nbsp;            TransferSofBlock(</b>
<b class="nc">&nbsp;                sofListState = sofState,</b>
<b class="nc">&nbsp;                sofList = sofList,</b>
<b class="nc">&nbsp;                transactionFee = state.invoice.firstOrNull()?.fee,</b>
<b class="nc">&nbsp;                isNoSof = isNoSofAvailable,</b>
<b class="nc">&nbsp;                onClickShowAll = viewModel::onClickShowAll,</b>
<b class="nc">&nbsp;                onPressSof = viewModel.sofSlice::changeSofIfNotSelected,</b>
<b class="nc">&nbsp;                onPressCta = viewModel.sofSlice::onPressCta,</b>
<b class="nc">&nbsp;                onLoaded = {},</b>
<b class="nc">&nbsp;                onAddSof = viewModel::addSof,</b>
<b class="nc">&nbsp;                onToggleBalance = viewModel.sofSlice::toggleHideBalance,</b>
<b class="nc">&nbsp;                number = windowSize,</b>
<b class="nc">&nbsp;                ctaList = cta,</b>
<b class="nc">&nbsp;                onPressNotice = viewModel.sofSlice::onPressNotice,</b>
<b class="nc">&nbsp;                isCollapsed = sofState.isCollapsed,</b>
<b class="nc">&nbsp;                onToggleExpand = { viewModel.sofSlice.toggleExpand(windowSize) }</b>
&nbsp;            )
&nbsp;        }
<b class="nc">&nbsp;        if (payLater != null &amp;&amp; !isNoSofAvailable) {</b>
<b class="nc">&nbsp;            blockKey(&quot;payment_pay_later_block&quot;) {</b>
<b class="nc">&nbsp;                TransferPayLaterBlock(</b>
<b class="nc">&nbsp;                    payLater = payLater,</b>
<b class="nc">&nbsp;                    sofListState = sofState,</b>
<b class="nc">&nbsp;                    onPressSof = viewModel.sofSlice::changeSofIfNotSelected,</b>
&nbsp;                )
&nbsp;            }
&nbsp;        }
&nbsp;    }
<b class="nc">&nbsp;}</b>
&nbsp;
&nbsp;fun formatSofListWithPromoteInvestment(
&nbsp;    sofList: PersistentList&lt;Sof&gt;,
&nbsp;    amount: Long,
&nbsp;    shortTitleBadge: String,
&nbsp;    titleAction: String,
&nbsp;): PersistentList&lt;Sof&gt; {
<b class="fc">&nbsp;    return sofList.map { sof -&gt;</b>
<b class="fc">&nbsp;        when (sof) {</b>
<b class="pc">&nbsp;            is SOFGroup -&gt; sof</b>
<b class="fc">&nbsp;            is SOFItem -&gt; {</b>
<b class="pc">&nbsp;                if (sof.isSource(EnumMoneySource.Investment)) {</b>
<b class="fc">&nbsp;                    sof.copy(</b>
<b class="fc">&nbsp;                        badge = SofBadge(</b>
<b class="fc">&nbsp;                            shortTitle = shortTitleBadge,</b>
<b class="fc">&nbsp;                            type = TaglineType.Promotion,</b>
<b class="fc">&nbsp;                            title = &quot;&quot;</b>
&nbsp;                        ),
<b class="fc">&nbsp;                        action = if (sof.disableType != DisableType.Show &amp;&amp; sof.balance &lt; amount) SofAction(</b>
<b class="fc">&nbsp;                            action = SofActionType.CashIn(</b>
<b class="fc">&nbsp;                                amount = amount - sof.balance,</b>
<b class="fc">&nbsp;                                targetSource = EnumMoneySource.Investment</b>
&nbsp;                            ),
<b class="fc">&nbsp;                            refId = ServiceFeatureCode.CashIn.code,</b>
<b class="fc">&nbsp;                            title = titleAction,</b>
<b class="fc">&nbsp;                            description = &quot;&quot;,</b>
<b class="fc">&nbsp;                            isShow = true,</b>
<b class="fc">&nbsp;                        ) else sof.action</b>
&nbsp;                    )
<b class="fc">&nbsp;                } else sof</b>
&nbsp;            }
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;    }.toPersistentList()</b>
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-06-18 18:24</div>
</div>
</body>
</html>
