


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>MoMoCompose Coverage Report > PaymentConfirmScreenKt</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope: MoMoCompose<span class="separator">|</span>    <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">vn.momo.compose.payment.payx.presentation.view.screens</a>
</div>

<h1>Coverage Summary for Class: PaymentConfirmScreenKt (vn.momo.compose.payment.payx.presentation.view.screens)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">PaymentConfirmScreenKt</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/19)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/43)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/687)
  </span>
</td>
</tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$PaymentConfirmScreenFull$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/28)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$PaymentConfirmScreenFull$2$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$PaymentConfirmScreenFull$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/29)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/374)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$PaymentConfirmScreenFull$6$amountInfo$2$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/28)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$PaymentConfirmScreenFull$7</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/20)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/197)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$PaymentConfirmScreenFull$focusAfterExpandDetail$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/27)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PaymentConfirmScreenKt$WhenMappings</td>
    <td class="coverageStat"/>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/27)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/37)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/100)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1350)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package vn.momo.compose.payment.payx.presentation.view.screens
&nbsp;
&nbsp;import androidx.compose.foundation.rememberScrollState
&nbsp;import androidx.compose.runtime.Composable
&nbsp;import androidx.compose.runtime.LaunchedEffect
&nbsp;import androidx.compose.runtime.collectAsState
&nbsp;import androidx.compose.runtime.derivedStateOf
&nbsp;import androidx.compose.runtime.getValue
&nbsp;import androidx.compose.runtime.mutableStateOf
&nbsp;import androidx.compose.runtime.produceState
&nbsp;import androidx.compose.runtime.remember
&nbsp;import androidx.compose.runtime.rememberCoroutineScope
&nbsp;import androidx.compose.runtime.setValue
&nbsp;import androidx.compose.ui.layout.positionInParent
&nbsp;import kotlinx.coroutines.launch
&nbsp;import org.jetbrains.compose.resources.stringResource
&nbsp;import vn.momo.compose.components.core.backhandler.BackHandler
&nbsp;import vn.momo.compose.payment.payx.presentation.features.paymentV1.view.screen.ConfirmScreenContent
&nbsp;import vn.momo.compose.payment.payx.presentation.features.paymentV2.view.component.FooterV2
&nbsp;import vn.momo.compose.payment.payx.presentation.features.paymentV2.view.screen.ConfirmContentV2
&nbsp;import vn.momo.compose.payment.payx.presentation.model.ProcessPayType
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.FooterSection
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.InfoRowContent
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.animation.linearTween
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.loading.ContentLoadingSkeleton
&nbsp;import vn.momo.compose.payment.payx.presentation.view.components.loading.FooterLoading
&nbsp;import vn.momo.compose.payment.payx.presentation.viewModel.PaymentConfirmVM
&nbsp;import vn.momo.compose.resources.Res
&nbsp;import vn.momo.compose.resources.paymentTitle
&nbsp;import vn.momo.kits.application.Screen
&nbsp;
&nbsp;@Composable
<b class="nc">&nbsp;fun PaymentConfirmScreen(viewModel: PaymentConfirmVM) {</b>
<b class="nc">&nbsp;    when (viewModel.props.getProcessPayType()) {</b>
&nbsp;        ProcessPayType.SHOW_CONFIRM_DIALOG,
&nbsp;        ProcessPayType.AUTHENTICATE_IMMEDIATELY,
<b class="nc">&nbsp;        ProcessPayType.BY_PASS_AUTHENTICATE_IMMEDIATELY -&gt; {</b>
<b class="nc">&nbsp;            PaymentConfirmScreenPopup(viewModel)</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        else -&gt; {</b>
<b class="nc">&nbsp;            PaymentConfirmScreenFull(viewModel)</b>
&nbsp;        }
&nbsp;    }
<b class="nc">&nbsp;}</b>
&nbsp;
&nbsp;@Composable
<b class="nc">&nbsp;fun PaymentConfirmScreenPopup(viewModel: PaymentConfirmVM) {</b>
<b class="nc">&nbsp;}</b>
&nbsp;
&nbsp;@Composable
<b class="nc">&nbsp;fun PaymentConfirmScreenFull(viewModel: PaymentConfirmVM) {</b>
<b class="nc">&nbsp;    val state by viewModel.state.collectAsState()</b>
<b class="nc">&nbsp;    val sofListState by viewModel.sofSlice.state.collectAsState()</b>
<b class="nc">&nbsp;    val version = sofListState.version</b>
<b class="nc">&nbsp;    val xSaleState by viewModel.xSaleSlice.state.collectAsState()</b>
<b class="nc">&nbsp;    val rewardState by viewModel.rewardSlice.state.collectAsState()</b>
<b class="nc">&nbsp;    val autoDebitState by viewModel.autoDebitSlice.state.collectAsState()</b>
&nbsp;
<b class="nc">&nbsp;    val hasAppliedPromotion by remember {</b>
<b class="nc">&nbsp;        derivedStateOf {</b>
<b class="nc">&nbsp;            state.promotion.promoDisplay.any { it.valid }</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
<b class="nc">&nbsp;    val scrollState = rememberScrollState()</b>
<b class="nc">&nbsp;    val uiScope = rememberCoroutineScope()</b>
&nbsp;
<b class="nc">&nbsp;    var anchorPosition by remember { mutableStateOf(0f) }</b>
<b class="nc">&nbsp;    var contentViewHeight by remember { mutableStateOf(0) }</b>
<b class="nc">&nbsp;    var waitForScroll by remember { mutableStateOf(false) }</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;    LaunchedEffect(state.sourceMessage) {</b>
<b class="nc">&nbsp;        if (state.sourceMessage?.isNotEmpty() == true) {</b>
<b class="nc">&nbsp;            viewModel.showToastMessage(state.sourceMessage)</b>
&nbsp;        }
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    LaunchedEffect(xSaleState.selected) {</b>
<b class="nc">&nbsp;        if (xSaleState.selected != null) {</b>
<b class="nc">&nbsp;            waitForScroll = true</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    fun goBack() {
<b class="nc">&nbsp;        viewModel.goBack()</b>
&nbsp;    }
&nbsp;
&nbsp;    fun focusAfterExpandDetail() {
<b class="nc">&nbsp;        if (waitForScroll) {</b>
<b class="nc">&nbsp;            uiScope.launch {</b>
<b class="nc">&nbsp;                scrollState.animateScrollTo(</b>
<b class="nc">&nbsp;                    (anchorPosition - contentViewHeight).toInt(),</b>
<b class="nc">&nbsp;                    animationSpec = linearTween(delayMillis = 50)</b>
&nbsp;                )
&nbsp;            }
<b class="nc">&nbsp;            waitForScroll = false</b>
&nbsp;        }
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    BackHandler(true) {</b>
<b class="nc">&nbsp;        goBack()</b>
&nbsp;    }
<b class="nc">&nbsp;    Screen(</b>
<b class="nc">&nbsp;        title = stringResource(Res.string.paymentTitle),</b>
<b class="nc">&nbsp;        goBack = ::goBack,</b>
<b class="nc">&nbsp;        headerRight = null,</b>
<b class="nc">&nbsp;        useAvoidKeyboard = false,</b>
<b class="nc">&nbsp;        scrollState = scrollState,</b>
<b class="nc">&nbsp;        onContentLayout = { contentViewHeight = it.size.height },</b>
<b class="nc">&nbsp;        content = {</b>
<b class="nc">&nbsp;            when {</b>
<b class="nc">&nbsp;                state.isLoading || version.code &lt; 1 -&gt; {</b>
<b class="nc">&nbsp;                    ContentLoadingSkeleton()</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                version.code == 1 -&gt; ConfirmScreenContent(</b>
<b class="nc">&nbsp;                    viewModel = viewModel,</b>
<b class="nc">&nbsp;                    sofListState = sofListState,</b>
<b class="nc">&nbsp;                    state = state,</b>
<b class="nc">&nbsp;                    hasAppliedPromotion = hasAppliedPromotion,</b>
<b class="nc">&nbsp;                    xSaleState = xSaleState,</b>
<b class="nc">&nbsp;                    autoDebitState = autoDebitState,</b>
<b class="nc">&nbsp;                    onAnimationEnd = ::focusAfterExpandDetail,</b>
<b class="nc">&nbsp;                    detectXSalePosition = { coor -&gt;</b>
<b class="nc">&nbsp;                        anchorPosition = coor.positionInParent().y + coor.size.height</b>
&nbsp;                    }
&nbsp;                )
&nbsp;
<b class="nc">&nbsp;                version.code == 2 -&gt; ConfirmContentV2(</b>
<b class="nc">&nbsp;                    state = state,</b>
<b class="nc">&nbsp;                    hasAppliedPromotion = hasAppliedPromotion,</b>
<b class="nc">&nbsp;                    viewModel = viewModel,</b>
<b class="nc">&nbsp;                    sofListState = sofListState,</b>
<b class="nc">&nbsp;                    rewardState = rewardState</b>
&nbsp;                )
<b class="nc">&nbsp;            }</b>
&nbsp;        },
<b class="nc">&nbsp;        footer = {</b>
<b class="nc">&nbsp;            when {</b>
<b class="nc">&nbsp;                state.isLoading || version.code &lt; 1 -&gt; {</b>
<b class="nc">&nbsp;                    FooterLoading()</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                version.code == 1 -&gt; FooterSection(</b>
<b class="nc">&nbsp;                    loadingState = state.isLoading,</b>
<b class="nc">&nbsp;                    amount = state.amount,</b>
<b class="nc">&nbsp;                    enableConfirm = state.enableConfirm,</b>
<b class="nc">&nbsp;                    promotion = state.promotion,</b>
<b class="nc">&nbsp;                    inlineMessage = state.inlineMessage ?: &quot;&quot;,</b>
<b class="nc">&nbsp;                    hasAppliedPromotion = hasAppliedPromotion,</b>
<b class="nc">&nbsp;                    onSelectPromotion = viewModel::navigateChoosePromotion,</b>
<b class="nc">&nbsp;                    hideAmount = state.hideAmount,</b>
<b class="nc">&nbsp;                    onConfirm = viewModel::onConfirm,</b>
<b class="nc">&nbsp;                    onToggleTotalAmount = { viewModel.trackToggleAmount(it, version) }</b>
&nbsp;                )
&nbsp;
<b class="nc">&nbsp;                version.code == 2 -&gt; {</b>
<b class="nc">&nbsp;                    val amountInfo by produceState(</b>
<b class="nc">&nbsp;                        initialValue = emptyList&lt;InfoRowContent&gt;(),</b>
<b class="nc">&nbsp;                        state.amount,</b>
<b class="nc">&nbsp;                        state.promotion.promoDisplay</b>
<b class="nc">&nbsp;                    ) {</b>
<b class="nc">&nbsp;                        value = viewModel.getAmountInfo(state.amount, state.promotion.promoDisplay)</b>
&nbsp;                    }
<b class="nc">&nbsp;                    FooterV2(</b>
<b class="nc">&nbsp;                        amount = state.amount,</b>
<b class="nc">&nbsp;                        hideAmount = state.hideAmount,</b>
<b class="nc">&nbsp;                        hasAppliedPromotion = hasAppliedPromotion,</b>
<b class="nc">&nbsp;                        enableConfirm = state.enableConfirm,</b>
<b class="nc">&nbsp;                        onConfirm = viewModel::onConfirm,</b>
<b class="nc">&nbsp;                        amountInfo = amountInfo,</b>
<b class="nc">&nbsp;                        onToggleShowAmount = { viewModel.trackToggleAmount(it, version) }</b>
&nbsp;                    )
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        })
<b class="nc">&nbsp;}</b>
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-07-08 10:52</div>
</div>
</body>
</html>
